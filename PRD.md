# PRD: 대형폐기물 품목 검색 시스템

## 1. 제품 개요

### 제품명
대형폐기물 품목 검색 시스템

### 목적
입력어와 의미적으로 가장 유사한 대형폐기물 품목을 제안하여 사용자가 원하는 품목의 수수료 정보를 쉽게 찾을 수 있도록 합니다.

### 핵심 문제
- 대형폐기물 품목명은 고정 단어로 지정됨
- 하나의 품목을 지칭하는 단어는 여러 표현 가능 (예: "티비" → "텔레비전(TV)")
- 지정된 단어가 아니면 의미적으로 유사해도 검색되지 않음

## 2. 기술 명세

| 항목 | 사양 |
|------|------|
| 데이터 규모 | 22,817개 품목 |
| 지역 범위 | 17개 시도 |
| 임베딩 모델 | ko-sroberta-multitask (jhgan/ko-sroberta-multitask) |
| 유사도 계산 | 코사인 유사도 |
| 결과 개수 | 상위 10개 (중복 포함) |

## 3. 시스템 아키텍처

```
┌─────────────────┐      ┌─────────────────┐
│   프론트엔드    │      │     백엔드      │
│  React + TS     │ ←──→ │Python + FastAPI │
└─────────────────┘      └─────────────────┘
        │                        │
        ▼                        ▼
   사용자 입력              임베딩 검색
   - 시도/시군구 필터        - 벡터 유사도 계산
   - 검색어 입력            - 상위 결과 반환
   - 결과 표시
```

### 프론트엔드 (React + TypeScript)
- 시도/시군구 드롭다운 필터
- 검색어 입력 필드
- 검색 결과 표시 (상위 5개)
- 수수료 정보 표시

### 백엔드 (Python)
- 임베딩 파일 로딩 (.npy)
- 입력어 벡터화
- 코사인 유사도 계산
- 검색 API 제공

## 4. 데이터 파이프라인

### 4.1 전처리
```
형식: "품목: <대형폐기물명> | 구분: <대형폐기물구분명>"
예시: "품목: 텔레비전(TV) | 구분: 가전제품"
```

### 4.2 임베딩 생성
- 입력: 전처리된 텍스트
- 모델: jhgan/ko-sroberta-multitask
- 출력: .npy 파일

### 4.3 런타임 검색
1. 임베딩 파일 로드 (앱 시작 시)
2. 사용자 입력 벡터화
3. 코사인 유사도 계산
4. 상위 5개 결과 반환

## 5. API 명세

### 검색 엔드포인트

```
POST /api/search
```

**Request Body**
```json
{
  "query": "티비",
  "sido": "서울특별시",
  "sigungu": "강남구"
}
```

**Response**
```json
{
  "results": [
    {
      "name": "텔레비전(TV)",
      "category": "가전제품",
      "spec": "32인치 이하",
      "fee": 5000,
      "similarity": 0.92
    }
  ]
}
```

## 6. 데이터 스키마

| 필드명 | 설명 |
|--------|------|
| 시도명 | 지역 시도 |
| 시군구명 | 지역 시군구 |
| 대형폐기물명 | 품목 이름 |
| 대형폐기물구분명 | 품목 분류 |
| 대형폐기물규격 | 크기/규격 |
| 유무료여부 | 무료/유료 구분 |
| 수수료 | 처리 비용 |

## 7. 향후 고려사항

### 성능 최적화
- FAISS 인덱스 적용 (대규모 검색 최적화)
- 배치 처리로 임베딩 생성 속도 개선

### 캐싱 전략
- 자주 검색되는 쿼리 캐싱
- 임베딩 결과 메모리 캐싱

### 확장 가능성
- 지역별 임베딩 분리 (메모리 효율화)
- 실시간 데이터 업데이트 파이프라인
